<!DOCTYPE html>
<!-- saved from url=(0068)http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/ -->
<html lang="en-US" class=" social-js"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width">
<title>LVM Loopback HOW-TO | Anthony's Blog</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/style.css">
<link rel="pingback" href="http://www.anthonyldechiaro.com/blog/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://www.anthonyldechiaro.com/blog/wp-content/themes/mf-inferno-v4.0/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Anthony&#39;s Blog » Feed" href="http://www.anthonyldechiaro.com/blog/feed/">
<link rel="alternate" type="application/rss+xml" title="Anthony&#39;s Blog » Comments Feed" href="http://www.anthonyldechiaro.com/blog/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Anthony&#39;s Blog » LVM Loopback HOW-TO Comments Feed" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.anthonyldechiaro.com\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.12"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="social_comments-css" href="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/comments.css" type="text/css" media="screen">
<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/jquery.js"></script>
<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/jquery-migrate.min.js"></script>
<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/jquery.lightbox.min.js"></script>
<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/jquery.lightbox.plugin.min.js"></script>
<link rel="https://api.w.org/" href="http://www.anthonyldechiaro.com/blog/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.anthonyldechiaro.com/blog/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.anthonyldechiaro.com/blog/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Upgrading EOL Ubuntu installations" href="http://www.anthonyldechiaro.com/blog/2010/12/14/upgrading-eol-ubuntu-installations/">
<link rel="next" title="Linux containers and ufw" href="http://www.anthonyldechiaro.com/blog/2011/01/11/linux-containers-and-ufw/">
<meta name="generator" content="WordPress 4.6.12">
<link rel="canonical" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/">
<link rel="shortlink" href="http://www.anthonyldechiaro.com/blog/?p=458">
<link rel="alternate" type="application/json+oembed" href="http://www.anthonyldechiaro.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.anthonyldechiaro.com%2Fblog%2F2010%2F12%2F19%2Flvm-loopback-how-to%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.anthonyldechiaro.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.anthonyldechiaro.com%2Fblog%2F2010%2F12%2F19%2Flvm-loopback-how-to%2F&amp;format=xml">
      
<script type="text/javascript">jQuery(function($) {
  $.Lightbox.construct({
    "show_linkback": false
  });
});</script>
      
<!-- Start Simple Author Highlighter -->
<style type="text/css">
.bypostauthor {background-color: #22160B !important; color:  ;}
.comment-author- {background-color:  !important; color: #B38255 ;}
</style>
<!-- Stop Simple Author Highlighter -->

<!-- Subscribe Sidebar widget -->
<link rel="stylesheet" href="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/subscribe_sidebar.css" type="text/css" media="screen">
<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style></head>

<body class="single single-post postid-458 single-format-standard single-author singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
			<hgroup>
				<h1 id="site-title"><span><a href="http://www.anthonyldechiaro.com/blog/" title="Anthony&#39;s Blog" rel="home">Anthony's Blog</a></span></h1>
				<h2 id="site-description">Thoughts, ideas, and ramblings on Linux, electronics and science</h2>
			</hgroup>


								<form method="get" id="searchform" action="http://www.anthonyldechiaro.com/blog/">
		<label for="s" class="assistive-text">Search</label>
		<input type="text" class="field" name="s" id="s" placeholder="Search">
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Search">
	<textarea name="" style="display: none;"></textarea></form>
					<div id="catnav">
        	<div id="toprss">
            <a href="feed:http://www.anthonyldechiaro.com/blog/feed/"><img src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/mf-rss-trans.png" alt="Anthony&#39;s Blog" width="65" height="24"></a>
            </div>
        
			<nav id="access" role="navigation">
				<h3 class="assistive-text">Main menu</h3>
								<div class="skip-link"><a class="assistive-text" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#content" title="Skip to primary content">Skip to primary content</a></div>
				<div class="skip-link"><a class="assistive-text" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#secondary" title="Skip to secondary content">Skip to secondary content</a></div>
								<div class="menu"><ul><li><a href="http://www.anthonyldechiaro.com/blog/">Home</a></li><li class="page_item page-item-2"><a href="http://www.anthonyldechiaro.com/blog/about/">About</a></li><li class="page_item page-item-23"><a href="http://www.anthonyldechiaro.com/blog/blogroll/">Blogroll</a></li><li class="page_item page-item-176"><a href="http://www.anthonyldechiaro.com/blog/ktux/">Ktux</a></li></ul></div>
			</nav><!-- #access -->
        </div><!-- #catnav -->  
	</header><!-- #branding -->


	<div id="main">
		<div id="primary">
			<div id="content" role="main">

				
					<nav id="nav-single">
						<h3 class="assistive-text">Post navigation</h3>
						<span class="nav-previous"><a href="http://www.anthonyldechiaro.com/blog/2010/12/14/upgrading-eol-ubuntu-installations/" rel="prev"><span class="meta-nav">←</span> Previous</a></span>
						<span class="nav-next"><a href="http://www.anthonyldechiaro.com/blog/2011/01/11/linux-containers-and-ufw/" rel="next">Next <span class="meta-nav">→</span></a></span>
					</nav><!-- #nav-single -->

					
<article id="post-458" class="post-458 post type-post status-publish format-standard hentry category-howto category-linux category-sysadmin tag-howto tag-linux tag-lvm tag-sysadmin">
	<header class="entry-header">
		<h1 class="entry-title">LVM Loopback HOW-TO</h1>

				<div class="entry-meta">
			<span class="sep">Posted on </span><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/" title="9:33 pm" rel="bookmark"><time class="entry-date" datetime="2010-12-19T21:33:32+00:00" pubdate="">December 19, 2010</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.anthonyldechiaro.com/blog/author/Anthony/" title="View all posts by Anthony DeChiaro" rel="author">Anthony DeChiaro</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
		<p style="text-align: justify;">This is a simple tutorial on setting up LVM on loopback devices, I’ve used it a few times for creating dynamic virtual disks; it came in particularly handy when archiving NEXRAD radar data for my <a href="http://www.anthonyldechiaro.com/blog/2010/10/06/radarwatch-uploaded-to-google-code/" target="_blank">radarwatchd project</a> – using up all your inodes on several hundreds of thousands of 15Kb files doesn’t sound like my idea of fun.&nbsp; Creating a virtual volume with reiserfs was a particularly handy solution in this case.</p>
<p><strong><span style="text-decoration: underline;">First Steps</span></strong></p>
<ul>
<li>Create several empty files with dd.&nbsp; These will hold your physical volumes:</li>
</ul>
<pre dir="ltr"># dd if=/dev/zero of=lvmtest0.img bs=100 count=1M
1048576+0 records in
1048576+0 records out
104857600 bytes (105 MB) copied, 8.69891 s, 12.1 MB/s
# dd if=/dev/zero of=lvmtest1.img bs=100 count=1M
1048576+0 records in
1048576+0 records out
104857600 bytes (105 MB) copied, 8.69891 s, 12.1 MB/s</pre>
<ul>
<li>Link them to loopback devices with losetup: (see below if you run out of loopback devices)</li>
</ul>
<pre dir="ltr"># losetup /dev/loop0 lvmtest0.img
# losetup /dev/loop1 lvmtest1.img</pre>
<ul>
<li>Partition them with fdisk.&nbsp; Create a single primary partition, full size of the device and set the type to Linux LVM (0x8e).&nbsp; Shorthand commands with fdisk: n,p,1,Enter,Enter,t,8e,w.&nbsp; I’ve also automated this somewhat with sfdisk:</li>
<pre dir="ltr"># sfdisk /dev/loop0 &lt;&lt; EOF
,,8e,,
EOF</pre>
<li>Install and configure LVM if needed.&nbsp; In this test I used the filter settings in lvm.conf to ensure only loopback devices will be used with LVM:</li>
</ul>
<pre dir="ltr">filter = [ "a|/dev/loop.*|", "r/.*/" ]</pre>
<ul>
<li>Initialize LVM:</li>
</ul>
<pre dir="ltr"># vgscan
Reading all physical volumes.&nbsp; This may take a while...
# vgchange -a</pre>
<ul>
<li>Create physical volumes with pvcreate:</li>
</ul>
<pre dir="ltr"># pvcreate /dev/loop0 /dev/loop1
 Physical volume "/dev/loop0" successfully created
 Physical volume "/dev/loop1" successfully created</pre>
<ul>
<li>Create a volume group then extend to include the second and any subsequent physical volumes:</li>
</ul>
<pre># vgcreate testvg /dev/loop0
 Volume group "testvg" successfully created
# vgextend testvg /dev/loop1
 Volume group "testvg" successfully extended</pre>
<ul>
<li>Verify the operation was successful:</li>
</ul>
<pre># vgdisplay -v
 Finding all volume groups
 Finding volume group "testvg"
 --- Volume group ---
 VG Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; testvg
 System ID
 Format&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvm2
 Metadata Areas&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2
 Metadata Sequence No&nbsp; 2
 VG Access&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; read/write
 VG Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resizable
 MAX LV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
 Cur LV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
 Open LV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
 Max PV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
 Cur PV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2
 Act PV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2
 VG Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.00 MB
 PE Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4.00 MB
 Total PE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 48
 Alloc PE / Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 / 0
 Free&nbsp; PE / Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 48 / 192.00 MB
 VG UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1Gmt3W-ivMH-mXQH-HswP-tjHR-9mAZ-917z0g

 --- Physical volumes ---
 PV Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /dev/loop0
 PV UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X11MYK-u8hk-4R26-CHuy-QUSw-2hLq-Notlnc
 PV Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allocatable
 Total PE / Free PE&nbsp;&nbsp;&nbsp; 24 / 24

 PV Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /dev/loop1
 PV UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dLKXlz-c536-9Elj-C2zZ-B4aw-69kj-zZ7PuN
 PV Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allocatable
 Total PE / Free PE&nbsp;&nbsp;&nbsp; 24 / 24</pre>
<ul>
<li>Create a logical volume.&nbsp; Use the largest available size reported to use by vgdisplay (Free PE/Size value):</li>
</ul>
<pre># lvcreate -L192M -ntest testvg
 Logical volume "test" created</pre>
<ul>
<li>Finally create a filesystem on the new logical volume.&nbsp; We’re using reiserfs for this example here:</li>
</ul>
<pre># mkfs.reiserfs /dev/mapper/testvg-test
mkfs.reiserfs 3.6.21 (2009 www.namesys.com)

A pair of credits:
Alexander&nbsp; Lyamin&nbsp; keeps our hardware&nbsp; running,&nbsp; and was very&nbsp; generous&nbsp; to our
project in many little ways.

The&nbsp; Defense&nbsp; Advanced&nbsp; Research&nbsp; Projects Agency (DARPA, www.darpa.mil) is the
primary sponsor of Reiser4.&nbsp; DARPA&nbsp; does&nbsp; not&nbsp; endorse&nbsp; this project; it merely
sponsors it.

Guessing about desired format.. Kernel 2.6.31-17-generic-pae is running.
Format 3.6 with standard journal
Count of blocks on the device: 49152
Number of blocks consumed by mkreiserfs formatting process: 8213
Blocksize: 4096
Hash function used to sort names: "r5"
Journal Size 8193 blocks (first block 18)
Journal Max transaction length 1024
inode generation number: 0
UUID: d50559af-5078-4de5-812a-264590e60177
ATTENTION: YOU SHOULD REBOOT AFTER FDISK!
 ALL DATA WILL BE LOST ON '/dev/mapper/testvg-test'!
Continue (y/n):y
Initializing journal - 0%....20%....40%....60%....80%....100%
Syncing..ok
ReiserFS is successfully created on /dev/mapper/testvg-test.</pre>
<ul>
<li>Mount the volume and you should be done:</li>
</ul>
<pre># mount /dev/mapper/testvg-test /mnt/virtlvm
# df
Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1K-blocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Used Available Use% Mounted on

/dev/mapper/testvg-test
 196596&nbsp;&nbsp;&nbsp;&nbsp; 32840&nbsp;&nbsp;&nbsp; 163756&nbsp; 17% /mnt/virtlvm</pre>
<p><strong><span style="text-decoration: underline;">Growing the LVM volume</span></strong></p>
<p>To expand the LVM volume you will follow similar steps to the ones stated above:</p>
<ul>
<li>Create another virtual disk and partition with dd and fdisk:</li>
</ul>
<pre># dd if=/dev/zero of=lvmtest2.img bs=100 count=1M
# fdisk /dev/loop2</pre>
<ul>
<li>Tie new disk image to a free loopback device with losetup:</li>
</ul>
<pre># losetup /dev/loop2 lvmtest2.img</pre>
<ul>
<li>Create physical volumes on the new device with pvcreate:</li>
</ul>
<pre># pvcreate /dev/loop2
Physical volume "/dev/loop2" successfully created</pre>
<ul>
<li>Extend the volume group:</li>
</ul>
<pre># vgextend testvg /dev/loop2
 Volume group "testvg" successfully extended</pre>
<ul>
<li>Extend the logical volume:</li>
</ul>
<pre># lvextend /dev/mapper/testvg-test /dev/loop2
 Extending logical volume test to 288.00 MB
 Logical volume test successfully resized</pre>
<ul>
<li>Resize the filesystem with resize_reiserfs:</li>
</ul>
<pre># resize_reiserfs /dev/mapper/testvg-test
resize_reiserfs 3.6.21 (2009 www.namesys.com)

resize_reiserfs: On-line resizing finished successfully.

# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/mapper/testvg-test
                        294896     32840    262056  12% /mnt/virtlvm</pre>
<p><strong><span style="text-decoration: underline;">Modifying the amount of loopback devices</span></strong></p>
<ul>
<li>To see all the loopback devices:</li>
</ul>
<pre dir="ltr"># ls -l /dev/loop*</pre>
<ul>
<li>Adding new loopback devices</li>
<li>If loopback support is compiled as a module:</li>
</ul>
<pre dir="ltr"># modprobe loop max_loop=64</pre>
<ul>
<li>To make permanent edit /etc/modules or /etc/modprobe.conf and use add one of the following:</li>
</ul>
<pre dir="ltr">loop max_loop=64
options loop max_loop=64</pre>
<ul>
<li>If loopback module is compiled into the kernel you will need to reboot, edit the kernel command-line parameters appending ‘max_loop=64’ to the end.</li>
<li style="text-align: justify;">Loopback devices can also be dynamically created with mknod.&nbsp; Loopback devices have a major number of 7 and minor number of the loopback device.&nbsp; Keep in mind devices created this way will not be persistent and will disappear after a reboot:</li>
</ul>
<pre dir="ltr"># mknod -m660 /dev/loop8 b 7 8
# mknod -m660 /dev/loop9 b 7 9
# mknod -m660 /dev/loop10 b 7 10</pre>
<p style="text-align: justify;">That should cover mostly everything.&nbsp; I’ve been informed that some of the steps may not be strictly necessary, such as the vgscan/vgchange.&nbsp; I also believe the partitioning may not be needed as we’re using the full size of the virtual devices but it’s good practice nonetheless and definitely makes things clearer being able to see the LVM partitions.&nbsp;&nbsp; Hope this helps!</p>


<div><em>If you enjoyed this post, make sure you <a href="http://www.anthonyldechiaro.com/blog/feed/">subscribe to my RSS feed</a>! </em></div>			</div><!-- .entry-content -->

	<footer class="entry-meta">
		This entry was posted in <a href="http://www.anthonyldechiaro.com/blog/category/howto/" rel="category tag">howto</a>, <a href="http://www.anthonyldechiaro.com/blog/category/linux/" rel="category tag">linux</a>, <a href="http://www.anthonyldechiaro.com/blog/category/linux/sysadmin/" rel="category tag">sysadmin</a> and tagged <a href="http://www.anthonyldechiaro.com/blog/tag/howto/" rel="tag">howto</a>, <a href="http://www.anthonyldechiaro.com/blog/tag/linux/" rel="tag">linux</a>, <a href="http://www.anthonyldechiaro.com/blog/tag/lvm/" rel="tag">lvm</a>, <a href="http://www.anthonyldechiaro.com/blog/tag/sysadmin/" rel="tag">sysadmin</a> by <a href="http://www.anthonyldechiaro.com/blog/author/Anthony/">Anthony DeChiaro</a>. Bookmark the <a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/" title="Permalink to LVM Loopback HOW-TO" rel="bookmark">permalink</a>.		
			</footer><!-- .entry-meta -->
</article><!-- #post-458 -->

					<div id="social">
		<div class="social-post">
		<div id="loading" style="display:none">
			<input type="hidden" id="reload_url" value="http://www.anthonyldechiaro.com/blog/index.php?social_controller=auth&amp;social_action=reload_form&amp;redirect_to=http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/&amp;post_id=458">
			Logging In...		</div>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Profile <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#respond" style="display:none;">cancel</a></small></h3>				<form action="http://www.anthonyldechiaro.com/blog/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<div class="social-sign-in-links social-clearfix">
		<a class="social-twitter social-imr social-login comments" href="http://www.anthonyldechiaro.com/blog/index.php?social_controller=auth&amp;social_action=authorize&amp;key=twitter&amp;post_id=458" id="twitter_signin" target="_blank">Sign in with Twitter</a>
		<a class="social-facebook social-imr social-login comments" href="http://www.anthonyldechiaro.com/blog/index.php?social_controller=auth&amp;social_action=authorize&amp;key=facebook&amp;post_id=458" id="facebook_signin" target="_blank">Sign in with Facebook</a>
	</div>
<div class="social-divider">
	<span>or</span>
</div>
<p class="social-input-row social-input-row-comment"><label for="comment" class="social-label">Comment</label><textarea id="comment" name="comment" class="social-input" required="required"></textarea></p><p class="social-input-row social-input-row-author"><label for="author" class="social-label">Name</label><input id="author" name="author" class="social-input" required="required" type="text" value="" style="background-image: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAfBJREFUWAntVk1OwkAUZkoDKza4Utm61iP0AqyIDXahN2BjwiHYGU+gizap4QDuegWN7lyCbMSlCQjU7yO0TOlAi6GwgJc0fT/fzPfmzet0crmD7HsFBAvQbrcrw+Gw5fu+AfOYvgylJ4TwCoVCs1ardYTruqfj8fgV5OUMSVVT93VdP9dAzpVvm5wJHZFbg2LQ2pEYOlZ/oiDvwNcsFoseY4PBwMCrhaeCJyKWZU37KOJcYdi27QdhcuuBIb073BvTNL8ln4NeeR6NRi/wxZKQcGurQs5oNhqLshzVTMBewW/LMU3TTNlO0ieTiStjYhUIyi6DAp0xbEdgTt+LE0aCKQw24U4llsCs4ZRJrYopB6RwqnpA1YQ5NGFZ1YQ41Z5S8IQQdP5laEBRJcD4Vj5DEsW2gE6s6g3d/YP/g+BDnT7GNi2qCjTwGd6riBzHaaCEd3Js01vwCPIbmWBRx1nwAN/1ov+/drgFWIlfKpVukyYihtgkXNp4mABK+1GtVr+SBhJDbBIubVw+Cd/TDgKO2DPiN3YUo6y/nDCNEIsqTKH1en2tcwA9FKEItyDi3aIh8Gl1sRrVnSDzNFDJT1bAy5xpOYGn5fP5JuL95ZjMIn1ya7j5dPGfv0A5eAnpZUY3n5jXcoec5J67D9q+VuAPM47D3XaSeL4AAAAASUVORK5CYII=&quot;); background-repeat: no-repeat; background-attachment: scroll; background-size: 16px 18px; background-position: 98% 50%;"></p>
<p class="social-input-row social-input-row-email"><label for="email" class="social-label">Email</label><input id="email" name="email" class="social-input" required="required" type="text" value=""><small class="social-help">Not published</small></p>
<p class="social-input-row social-input-row-url"><label for="url" class="social-label">Website</label><input id="url" name="url" class="social-input" type="text" value=""></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post It"> <input type="hidden" name="comment_post_ID" value="458" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
<input type="hidden" id="use_twitter_reply" name="use_twitter_reply" value="0"><input type="hidden" id="in_reply_to_status_id" name="in_reply_to_status_id" value=""></p><div id="commentform-extras"><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="b6d5fd3716"></p><p style="display: none;"></p></div>				<input type="hidden" id="ak_js" name="ak_js" value="1541125344650"></form>
					</div><!-- #respond -->
			</div>
	<div id="social-tabs-comments">
				<ul class="social-nav social-clearfix">
			<li class="social-all social-tab-main social-current-tab"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" rel="social-all"><span>3 Replies</span></a></li>
			<li class="social-wordpress"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" rel="wordpress"><span>3 Comments</span></a></li>
			<li class="social-twitter"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" rel="social-twitter"><span>0 Tweets</span></a></li>
			<li class="social-facebook"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" rel="social-facebook"><span>0 Facebook</span></a></li>
			<li class="social-pingback"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" rel="social-pingback"><span>0 Pingbacks</span></a></li>
		</ul>

		<!-- panel items -->
		<div id="social-comments-tab-all" class="social-tabs-panel social-tabs-first-panel">
			<div id="comments" class="social-comments">
				<div class="social-last-reply-when">Last reply was January 22, 2014</div><div class="cf-clearfix"></div>				<ol class="social-commentlist">
				<li class="wordpress even thread-even depth-1 social-comment social-clearfix social-wordpress" id="li-comment-1782">
<div class="social-comment-inner social-clearfix" id="comment-1782">
	<div class="social-comment-header">
		<div class="social-comment-author vcard">
			<img alt="" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/c0b47ad2b993f3187f9358f6dfcde7bb.png" srcset="http://0.gravatar.com/avatar/c0b47ad2b993f3187f9358f6dfcde7bb?s=80&amp;d=mm&amp;r=pg 2x" class="avatar avatar-40 photo" height="40" width="40"><cite class="social-fn fn">John</cite>		</div>
		<!-- .comment-author .vcard -->
		<div class="social-comment-meta social-comment-meta-wordpress">
			<span class="social-posted-from">
								<span>View</span>
							</span>
			<a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#comment-1782" class="social-posted-when" target="_blank">August 7, 2012</a>
		</div>
	</div>
	<div class="social-comment-body">
				<p>Thanks for that.  It helped me get a loop device installed on an OpenFiler box.<br>
Using it via iSCSI on Windows as I type.<br>
Appreciated.</p>
	</div>
			<div class="social-actions entry-meta">
		<a rel="nofollow" class="comment-reply-link" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/?replytocom=1782#respond" onclick="return addComment.moveForm( &quot;comment-1782&quot;, &quot;1782&quot;, &quot;respond&quot;, &quot;458&quot; )" aria-label="Reply to John">Reply</a>	</div>
		<!-- .reply -->
</div><!-- #comment-1782 -->
</li><!-- #comment-## -->
<li class="wordpress odd alt thread-odd thread-alt depth-1 social-comment social-clearfix social-wordpress" id="li-comment-1856">
<div class="social-comment-inner social-clearfix" id="comment-1856">
	<div class="social-comment-header">
		<div class="social-comment-author vcard">
			<img alt="" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/618f62e027d7a73252b423470d37814c.png" srcset="http://0.gravatar.com/avatar/618f62e027d7a73252b423470d37814c?s=80&amp;d=mm&amp;r=pg 2x" class="avatar avatar-40 photo" height="40" width="40"><cite class="social-fn fn"><a href="http://blog.schmitt.io/" rel="external nofollow" class="url">Oliver</a></cite>		</div>
		<!-- .comment-author .vcard -->
		<div class="social-comment-meta social-comment-meta-wordpress">
			<span class="social-posted-from">
								<span>View</span>
							</span>
			<a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#comment-1856" class="social-posted-when" target="_blank">March 29, 2013</a>
		</div>
	</div>
	<div class="social-comment-body">
				<p>Thank you for this post. It is a great tutorial. I used it to setup my lvm!</p>
	</div>
			<div class="social-actions entry-meta">
		<a rel="nofollow" class="comment-reply-link" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/?replytocom=1856#respond" onclick="return addComment.moveForm( &quot;comment-1856&quot;, &quot;1856&quot;, &quot;respond&quot;, &quot;458&quot; )" aria-label="Reply to Oliver">Reply</a>	</div>
		<!-- .reply -->
</div><!-- #comment-1856 -->
</li><!-- #comment-## -->
<li class="wordpress even thread-even depth-1 social-comment social-clearfix social-wordpress" id="li-comment-1948">
<div class="social-comment-inner social-clearfix" id="comment-1948">
	<div class="social-comment-header">
		<div class="social-comment-author vcard">
			<img alt="" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/37d90db7c770a3bbcfbf4e2e278f72d3.png" srcset="http://0.gravatar.com/avatar/37d90db7c770a3bbcfbf4e2e278f72d3?s=80&amp;d=mm&amp;r=pg 2x" class="avatar avatar-40 photo" height="40" width="40"><cite class="social-fn fn">KK</cite>		</div>
		<!-- .comment-author .vcard -->
		<div class="social-comment-meta social-comment-meta-wordpress">
			<span class="social-posted-from">
								<span>View</span>
							</span>
			<a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#comment-1948" class="social-posted-when" target="_blank">January 22, 2014</a>
		</div>
	</div>
	<div class="social-comment-body">
				<p>This is excellent, thank you very much!<br>
Is there any way of making the loop devices and partitions persistent across reboots, apart from scripting the above steps into init/rc scripts?<br>
Thanks!</p>
	</div>
			<div class="social-actions entry-meta">
		<a rel="nofollow" class="comment-reply-link" href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/?replytocom=1948#respond" onclick="return addComment.moveForm( &quot;comment-1948&quot;, &quot;1948&quot;, &quot;respond&quot;, &quot;458&quot; )" aria-label="Reply to KK">Reply</a>	</div>
		<!-- .reply -->
</div><!-- #comment-1948 -->
</li><!-- #comment-## -->
				</ol>
							</div>
		</div>
			</div>
	<!-- #Comments Tabs -->
	</div>

				
			</div><!-- #content -->
		</div><!-- #primary -->


	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

			<div id="site-generator">
								Powered by <a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator"> WordPress</a><br>
Theme by <a href="http://www.thecirclingsky.com/">The Cirdeling Sky</a> <br>
			</div>
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/form.js"></script>
<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var Sociali18n = {"commentReplyTitle":"Post a Reply"};
/* ]]> */
</script>
<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/social.js"></script>
<script type="text/javascript" src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/wp-embed.min.js"></script>


<link type="text/css" rel="stylesheet" media="screen" href="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/jquery.lightbox.min.css" id="lightbox-stylesheet-lightbox"><div id="lightbox-overlay" style="width: 1680px; height: 5943px; display: none;"><div id="lightbox-overlay-text"><p><span id="lightbox-overlay-text-close">Click to close</span><br>&nbsp;<span id="lightbox-overlay-text-interact" style="display: none;">Hover to interact</span></p></div></div><div id="lightbox" style="display: none; left: 0px; top: 164px;"><div id="lightbox-imageBox"><div id="lightbox-imageContainer"><img id="lightbox-image"><div id="lightbox-nav"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" id="lightbox-nav-btnPrev"></a><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" id="lightbox-loading-link"><img src="./LVM Loopback HOW-TO _ Anthony&#39;s Blog_files/loading.gif"></a></div></div></div><div id="lightbox-infoBox"><div id="lightbox-infoContainer"><div id="lightbox-infoHeader"><span id="lightbox-caption"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" title="Download." id="lightbox-caption-title"></a><span id="lightbox-caption-seperator"></span><span id="lightbox-caption-description"></span></span></div><div id="lightbox-infoFooter"><span id="lightbox-currentNumber"></span><span id="lightbox-close"><a href="http://www.anthonyldechiaro.com/blog/2010/12/19/lvm-loopback-how-to/#" id="lightbox-close-button" title="You can also click anywhere outside the image to close.">Close X</a></span></div><div id="lightbox-infoContainer-clear"></div></div></div></div></body></html>